<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libstuc: say.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libstuc
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">C library of useful things</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('say_8c-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">say.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>This is an example of how to use the netTcpClient This starts off by using the cmd line parsing routines to get the desired port number to send data do. Then it sends out the string Hello World to that port</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="stulibc_8h.html">stulibc.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">char</span> *program_name;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// socket s represents an established connection(connect already called),</span></div><div class="line"><span class="comment">// peerp represents the server that the connection was established with</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> client( <a class="code" href="skel_8h.html#a8dc8083897335125630f1af5dafd5831">SOCKET</a> s, <span class="keyword">struct</span> sockaddr_in *peerp )</div><div class="line">{</div><div class="line">    <span class="keywordtype">char</span>* buf[265];</div><div class="line"><span class="comment">//    int got = netReadLine( s, buf,256);</span></div><div class="line"><span class="comment">//    PRINT(&quot;%s\n&quot;,buf);</span></div><div class="line"> <span class="comment">//   LOG( &quot;GOT %d bytes&quot;,got);</span></div><div class="line">    <span class="keywordtype">int</span> rc = send( s, <span class="stringliteral">&quot;Hello World\n&quot;</span>,13,0);</div><div class="line">    <a name="a0"></a><a class="code" href="logging_8h.html#a018a1fe4b078f1a684610657a5848860">LOG</a>( <span class="stringliteral">&quot;send out %d bytes&quot;</span>,rc);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> port[20] = {0};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> set_port_num(<span class="keywordtype">char</span>* arg)</div><div class="line">{</div><div class="line">    <a name="a1"></a><a class="code" href="safetychecking_8h.html#ab20ea3bec99b1e19503a964bd24116e8">CHECK_STRING</a>(arg, <a name="a2"></a><a class="code" href="safetychecking_8h.html#ab5348863e9849229342e645b2839779ca57e30711275caa3d02bd963f380db548">IS_NOT_EMPTY</a>);</div><div class="line">    strncpy( port, arg, strlen(arg));</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/* main - connect to the server */</span></div><div class="line"><span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv )</div><div class="line">{</div><div class="line">    <a name="a3"></a><a class="code" href="stulibc_8h.html#aa8055d34c62131aa7021569167c6a3d7">LIB_Init</a>();</div><div class="line">    </div><div class="line">    <span class="keyword">struct </span><a name="_a4"></a><a class="code" href="struct_argument.html">Argument</a>* portNumber = <a name="a5"></a><a class="code" href="cmdline_8h.html#a7d462647748e26ba7d571cb3a5d3da2a">CMD_CreateNewArgument</a>(<span class="stringliteral">&quot;port&quot;</span>,<span class="stringliteral">&quot;port &lt;number&gt;&quot;</span>,<span class="stringliteral">&quot;Set the port to connect to&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, set_port_num);</div><div class="line">    <a name="a6"></a><a class="code" href="cmdline_8h.html#a6a62bfcf623c152c13715afeaf21c7d4">CMD_AddArgument</a>(portNumber);</div><div class="line">    </div><div class="line">    <span class="keywordflow">if</span>( argc &gt; 1 )</div><div class="line">        <a name="a7"></a><a class="code" href="cmdline_8h.html#af079c07f60978cc725cdab43b8ffdef4">CMD_Parse</a>(argc,argv,<span class="keyword">true</span>);</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a name="a8"></a><a class="code" href="cmdline_8h.html#af4d31f8fab2c04566d9c009286903fd3">CMD_ShowUsages</a>(<span class="stringliteral">&quot;say&quot;</span>, <span class="stringliteral">&quot;stumathews@gmail.com&quot;</span>, <span class="stringliteral">&quot;say example&quot;</span>);</div><div class="line">        exit(0);</div><div class="line">    }</div><div class="line">        </div><div class="line">    <span class="keyword">struct </span>sockaddr_in peer;</div><div class="line">        <a class="code" href="skel_8h.html#a8dc8083897335125630f1af5dafd5831">SOCKET</a> s;</div><div class="line"></div><div class="line">        <a name="a9"></a><a class="code" href="skel_8h.html#a7bbeef413b28058f35d29379a3169f56">NETINIT</a>();</div><div class="line">    </div><div class="line">    <span class="comment">// Establish a connection(calls connect) and return the socket that represents that connection.</span></div><div class="line">        s = <a name="a10"></a><a class="code" href="etcp_8h.html#a25ef5399eaaf703ad11f6205af5f43f3">netTcpClient</a>(<span class="stringliteral">&quot;localhost&quot;</span>,port);</div><div class="line">    <span class="comment">// call blocking network functions</span></div><div class="line">    <a class="code" href="logging_8h.html#a018a1fe4b078f1a684610657a5848860">LOG</a>(<span class="stringliteral">&quot;about to write&quot;</span>);</div><div class="line">        client( s, &amp;peer );</div><div class="line">        <a name="a11"></a><a class="code" href="skel_8h.html#a9e1ff4f7434a7d69c13dfd58cb923e93">EXIT</a>( 0 );</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jun 23 2018 22:07:03 for libstuc by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
